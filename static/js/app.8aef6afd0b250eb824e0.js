webpackJsonp([1],{"7zck":function(e,a){},NHnr:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=t("7+uW"),o=t("3EgV"),i=t.n(o),n=new r.a,l=t("1e2d"),s=t.n(l),c=t("M4fF"),u=t.n(c),d={name:"layer-control",props:{layers:{type:Array,required:!0},map:{type:Object}},data:function(){return{returnPeriod:null,selectResults:null,selectHazards:null}},mounted:function(){},watch:{layers:{handler:function(e){this.toggleLayers()},deep:!0},returnPeriod:{handler:function(e){this.toggleLayers()},deep:!0},selectResults:{handler:function(e){this.selectResults=e,this.toggleLayers()},deep:!0},selectHazards:{handler:function(e){this.selectHazards=e,this.toggleLayers()},deep:!0}},methods:{deferredMountedTo:function(){},toggleLayers:function(){var e=this;if(!u.a.isNil(this.map)){var a=["none","visible"];u.a.each(this.layers,function(t){u.a.each(t.json_layers,function(r){console.log(r.data),u.a.each(r.data,function(o){t.active&&(e.returnPeriod===o.returnPeriod||e.selectResults===r.name&&o.hazard===e.selectHazards||"Exposure"===t.content)?(console.log("YAAAAY",o.id),e.map.setLayoutProperty(o.id,"visibility",a[1])):e.map.setLayoutProperty(o.id,"visibility",a[0])})})})}}}},p={render:function(){var e=this,a=e.$createElement,r=e._self._c||a;return r("div",{staticClass:"layer-control"},[r("v-list-tile",[r("v-list-tile-title",[e._v("\r\n      Return period\r\n    ")])],1),e._v(" "),r("v-list-tile",[r("v-list-tile-sub-title",["Coastal Flood"==e.selectHazards?r("v-radio-group",{model:{value:e.returnPeriod,callback:function(a){e.returnPeriod=a},expression:"returnPeriod"}},[r("v-layout",{attrs:{row:""}},e._l([25,100,500],function(e){return r("v-radio",{key:e,attrs:{label:" "+e,value:e}})}))],1):e._e(),e._v(" "),"EarthQuake"==e.selectHazards?r("v-radio-group",{model:{value:e.returnPeriod,callback:function(a){e.returnPeriod=a},expression:"returnPeriod"}},[r("v-layout",{attrs:{row:""}},e._l([952,3935,8647],function(e){return r("v-radio",{key:e,attrs:{label:" "+e,value:e}})}))],1):e._e()],1)],1),e._v(" "),e._l(e.layers,function(a){return"Exposure"==a.content?r("v-list",{key:a.id,attrs:{dense:"","pt-0":""}},[e._v("\r\n    School Exposure\r\n    "),r("v-divider"),e._v(" "),r("v-list-tile",[r("v-list-tile-action",[r("v-switch",{model:{value:a.active,callback:function(t){e.$set(a,"active",t)},expression:"layer.active"}})],1),e._v(" "),r("v-list-tile-title",[e._v(e._s(a.name))]),e._v(" "),r("v-list-tile-action",[r("v-icon",[e._v(e._s(a.icon))])],1)],1)],1):e._e()}),e._v(" "),e._l(e.layers,function(a){return"Hazards"==a.content?r("v-list",{key:a.id,attrs:{dense:"","pt-0":""}},[e._v("\r\n    Hazards\r\n    "),r("v-divider"),e._v(" "),r("v-list-tile",[r("v-list-tile-action",[r("v-switch",{model:{value:a.active,callback:function(t){e.$set(a,"active",t)},expression:"layer.active"}})],1),e._v(" "),r("v-list-tile-title",[r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectHazards,expression:"selectHazards"}],attrs:{label:"Select","item-text":"name","item-value":"name",light:"","single-line":"",auto:""},on:{change:function(a){var t=Array.prototype.filter.call(a.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selectHazards=a.target.multiple?t:t[0]}}},e._l(a.json_layers,function(a){return r("option",{key:a.id,domProps:{value:a.name}},[e._v("\r\n          "+e._s(a.name)+"\r\n        ")])}))]),e._v(" "),r("v-list-tile-action",[r("v-icon",[e._v(e._s(a.icon))])],1)],1),e._v(" "),"Coastal Flood"==e.selectHazards?r("div",{staticClass:"bar-wrapper"},[a.css_CF?r("div",{staticClass:"bar",style:a.css_CF}):e._e(),e._v(" "),r("div",{staticClass:"bartext"},[e._v(e._s(a.range_CF)+" "),r("span",{staticClass:"barspan"})])]):e._e(),e._v(" "),"EarthQuake"==e.selectHazards?r("div",{staticClass:"bar-wrapper"},[a.css_EQ?r("div",{staticClass:"bar",style:a.css_EQ}):e._e(),e._v(" "),r("div",{staticClass:"bartext"},[e._v(e._s(a.range_EQ)+" "),r("span",{staticClass:"barspan"})])]):e._e()],1):e._e()}),e._v(" "),e._l(e.layers,function(a){return"Results"==a.content?r("v-list",{key:a.id,attrs:{dense:"","pt-0":""}},[e._v("\r\n    Results\r\n    "),r("v-divider"),e._v(" "),r("v-list-tile",[r("v-list-tile-action",[r("v-switch",{model:{value:a.active,callback:function(t){e.$set(a,"active",t)},expression:"layer.active"}})],1),e._v(" "),r("v-list-tile-title",[r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectResults,expression:"selectResults"}],attrs:{label:"Select","item-text":"name","item-value":"name",light:"","single-line":"",auto:""},on:{change:function(a){var t=Array.prototype.filter.call(a.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selectResults=a.target.multiple?t:t[0]}}},e._l(a.json_layers,function(a){return r("option",{key:a.name,domProps:{value:a.name}},[e._v("\r\n          "+e._s(a.name)+"\r\n        ")])}))]),e._v(" "),r("v-list-tile-action",[r("v-icon",[e._v(e._s(a.icon))])],1)],1),e._v(" "),r("div",{staticClass:"bar-wrapper"},[a.css?r("div",{staticClass:"bar",style:a.css}):e._e(),e._v(" "),r("div",{staticClass:"bartext"},[e._v(e._s(a.range)+" "),r("span",{staticClass:"barspan"})]),e._v(" "),r("div",{staticClass:"information",domProps:{innerHTML:e._s(a.info)}},[e._v(e._s(a.info)+" ")])])],1):e._e()}),e._v(" "),r("img",{attrs:{id:"logos",src:t("xcLp")}})],2)},staticRenderFns:[]};var v=t("VU/8")(d,p,!1,function(e){t("Qj4d")},null,null).exports,m={name:"v-hazards",data:function(){return{map:null}},mounted:function(){},methods:{deferredMountedTo:function(e){var a={name:"Hazards",id:"hazards",icon:"priority_high",active:!1,content:"Hazards",json_layers:[],range_CF:"0 700",css_CF:"background: linear-gradient(to right,           rgba(247,251,255,40),           rgba(104,160,213,117),           rgba(60,148,201,166),           rgba(49,118,163,202),           rgba(25,86,138,223),           rgba(9,57,129,255))",range_EQ:"0 600",css_EQ:"background: linear-gradient(to right, #f9faa1, #f6f592, #f2ea69,            #f6d746, #fac42a, #fcb014, #fb9d07, #f58c08, #f47918, #ed6925, #e45a31,            #d94d3d, #cc4248, #bf3952, #b0315b, #a02a63, #902568, #801f6c, #71196e,            #61136e, #510e6c, #400a67, #2f0a5b, #1e0c45, #10092d, #050417, #000004)"},t={name:"Coastal Flood",data:[{id:"CF-layer-25",layout:{visibility:"none"},type:"raster",returnPeriod:25,source:{type:"raster",url:"mapbox://joaolima.588zuz9x",tileSize:256}},{id:"CF-layer-100",layout:{visibility:"none"},type:"raster",returnPeriod:100,source:{type:"raster",url:"mapbox://joaolima.awl4l0w6",tileSize:256}},{id:"CF-layer-500",layout:{visibility:"none"},type:"raster",returnPeriod:500,source:{type:"raster",url:"mapbox://joaolima.84gdnnj5",tileSize:256}}]},r={name:"EarthQuake",data:[{id:"EQ-layer-952",layout:{visibility:"none"},type:"raster",returnPeriod:952,source:{type:"raster",url:"mapbox://joaolima.7enpsj6a",tileSize:256}},{id:"EQ-layer-3935",layout:{visibility:"none"},type:"raster",returnPeriod:3935,source:{type:"raster",url:"mapbox://joaolima.awl4l0w6",tileSize:256}},{id:"EQ-layer-8647",layout:{visibility:"none"},type:"raster",returnPeriod:8647,source:{type:"raster",url:"mapbox://joaolima.br98oxaa",tileSize:256}}]};a.json_layers.push(t),a.json_layers.push(r),_.each(t.data,function(a){e.addLayer(a)}),_.each(r.data,function(a){e.addLayer(a)}),console.log("hazard_layer",a),n.$emit("add-layer",a)}}},y={name:"v-results-layers",data:function(){return{map:null}},mounted:function(){},methods:{deferredMountedTo:function(e){var a=this,t={active:!1,content:"Results",icon:"view_list",id:"results-id",json_layers:[]};this.map=e;var r=[{name:"Conventional USD",textcolor:"rgba(199, 23, 220, 1)",data:[{hazard:"Coastal Flood",id:"CF-conventional-usd",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.4ph2ua2g"},"source-layer":"CF_conventional_usd-a3oswd",paint:{"fill-color":"rgba(199, 23, 220, 0.26)","fill-outline-color":"rgba(199, 23, 220, 1)"}},{hazard:"EarthQuake",id:"EQ-conventional-usd",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.7zimfshz"},"source-layer":"EQ_conventional_usd-0w18ma",paint:{"fill-color":"rgba(199, 23, 220, 0.26)","fill-outline-color":"rgba(199, 23, 220, 1)"}}]},{name:"Unconventional USD",textcolor:"rgba(0, 64, 231, 1)",data:[{hazard:"Coastal Flood",id:"CF-unconventional-usd",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.3sywikko"},"source-layer":"CF_unconventional_count30-dwzjx9",paint:{"fill-color":"rgba(0, 64, 231, 0.26)","fill-outline-color":"rgba(0, 64, 231, 1)"}},{hazard:"EarthQuake",id:"EQ-unconventional-usd",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.5bsudt95"},"source-layer":"EQ_unconventional_usd-6b4jai",paint:{"fill-color":"rgba(0, 64, 231, 0.26)","fill-outline-color":"rgba(0, 64, 231, 1)"}}]},{name:"Conventional count",textcolor:"rgba(242, 220, 19, 1)",data:[{hazard:"Coastal Flood",id:"CF-conventional-count",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.15kwtp2e"},"source-layer":"CF_conventional_count30-887azr",paint:{"fill-color":"rgba(242, 220, 19, 0.26)","fill-outline-color":"rgba(242, 220, 19, 1)"}},{hazard:"EarthQuake",id:"EQ-conventional-count",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.45biq1lh"},"source-layer":"EQ_conventional_count-dvud0r",paint:{"fill-color":"rgba(242, 220, 19, 0.26)","fill-outline-color":"rgba(242, 220, 19, 1)"}}]},{name:"Unconventional Count",textcolor:"rgba(52, 220, 58, 1)",data:[{hazard:"Coastal Flood",id:"CF-unconventional-count",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.3sywikko"},"source-layer":"CF_unconventional_count30-dwzjx9",paint:{"fill-color":"rgba(52, 220, 58, 0.26)","fill-outline-color":"rgba(52, 220, 58, 1)"}},{hazard:"EarthQuake",id:"EQ-unconventional-count",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.0rn8aiji"},"source-layer":"EQ_unconventional_count-axxh45",paint:{"fill-color":"rgba(52, 220, 58, 0.26)","fill-outline-color":"rgba(52, 220, 58, 1)"}}]},{name:"Pupils",textcolor:"rgba(250, 24, 21, 1)",data:[{hazard:"EarthQuake",id:"EQ-pupils",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.5ku77z5c"},"source-layer":"EQ_pupils-9ftcxb",paint:{"fill-color":"rgba(250, 24, 21, 0.26)","fill-outline-color":"rgba(250, 24, 21, 1)"}},{hazard:"Coastal Flood",id:"CF-pupils",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.36ig2zci"},"source-layer":"CF_pupils-4q3ft2",paint:{"fill-color":"rgba(250, 24, 21, 0.26)","fill-outline-color":"rgba(250, 24, 21, 1)"}}]}];_.each(r,function(e){t.json_layers.push(e),_.each(e.data,function(e){a.map.addLayer(e)})}),n.$emit("add-layer",t)}}},f={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"hidden"})},staticRenderFns:[]};var b=t("VU/8")(y,f,!1,function(e){t("jQz1")},"data-v-819a8bac",null).exports,h={name:"v-exposure-layers",data:function(){return{map:null}},mounted:function(){},methods:{deferredMountedTo:function(e){var a={active:!1,content:"Exposure",icon:"home",id:"results",name:"Combined exposure",json_layers:[]},t={name:"Combined exposure",textcolor:"rgba(199, 23, 220, 1)",data:[{id:"combined-exposure",layout:{visibility:"none"},type:"circle",source:{type:"vector",url:"mapbox://joaolima.cg24n2xe"},"source-layer":"Combined_Exposure-3noze9",paint:{}}]};this.map=e,a.json_layers.push(t),this.map.addLayer(t.data[0]),n.$emit("add-layer",a)}}},g={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"hidden"})},staticRenderFns:[]};var x={name:"app",data:function(){return{map:null,drawer:null,layers:[],headers:[],items:[]}},mounted:function(){var e=this;this.map=this.$refs.map.map;var a=new s.a.Popup({}),t=document.getElementById("popupinfo");a.setDOMContent(t),n.$on("select-layers",function(a){r.a.set(e,"layers",a)}),n.$on("add-layer",function(a){e.layers.push(a)}),this.map.on("error",function(e){return console.log(e)}),this.map.on("load",function(t){n.$emit("map-loaded",e.$refs.map.map),e.map.addControl(new s.a.NavigationControl),e.map.on("mousemove",function(a){e.$refs.map.map.getCanvas().style.cursor="",void 0!==e.map.queryRenderedFeatures(a.point)[0]&&(e.$refs.map.map.getCanvas().style.cursor="pointer")}),e.map.on("click",function(t){a.remove();var r=e.map.queryRenderedFeatures(t.point);"combined-exposure"===r[0].layer.id?(e.items=[{value:!1,name:"Name",data:r[0].properties.Name},{value:!1,name:"type",data:r[0].properties.Type},{value:!1,name:"Pupils fin",data:r[0].properties.PUPILS_FIN},{value:!1,name:"Total ReCost",data:r[0].properties.Tot_ReCost},{value:!1,name:"UNCON_FINA",data:r[0].properties.UNCON_FINA}],e.headers=[{text:r[0].properties.ADM1_NAME+", "+r[0].properties.ADM2_NAME,align:"left",sortable:!1,value:"name"},{text:"data",value:"data"}],a.setLngLat(t.lngLat).addTo(e.map)):"combined-exposure"!==r[0].layer.id&&(e.items=[{value:!1,name:"Name",data:r[0].layer.id},{value:!1,name:"Return period: 10 years",data:r[0].properties[10]},{value:!1,name:"Return period: 100 years",data:r[0].properties[100]},{value:!1,name:"Return period: 500 years",data:r[0].properties[500]},{value:!1,name:"Annual Expected Damage",data:r[0].properties.AED}],e.headers=[{text:r[0].properties.ADM1_NAME+", "+r[0].properties.ADM2_NAME,align:"left",sortable:!1,value:"name"},{text:"Data",value:"data"}],a.setLngLat(t.lngLat).addTo(e.map))})})},watch:{},methods:{},components:{"layer-control":v,"v-hazards":m,"v-exposure-layers":t("VU/8")(h,g,!1,function(e){t("t9Zi")},"data-v-56752b5c",null).exports,"v-results-layers":b}},C={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-app",{attrs:{id:"inspire"}},[t("v-navigation-drawer",{attrs:{fixed:"",app:""},model:{value:e.drawer,callback:function(a){e.drawer=a},expression:"drawer"}},[t("v-toolbar",{attrs:{flat:""}},[t("v-list",[t("v-list-tile",[t("v-list-tile-title",{staticClass:"title"},[e._v("\r\n            Layers\r\n          ")])],1)],1)],1),e._v(" "),t("layer-control",{attrs:{layers:e.layers,map:e.map}})],1),e._v(" "),t("v-toolbar",{attrs:{color:"indigo",dark:"",fixed:"",app:""}},[t("v-toolbar-side-icon",{on:{click:function(a){a.stopPropagation(),e.drawer=!e.drawer}}}),e._v(" "),t("v-toolbar-title",[e._v("Safer schools viewer")])],1),e._v(" "),t("v-content",[t("div",{attrs:{id:"map"}},[t("v-mapbox",{ref:"map",attrs:{"access-token":"pk.eyJ1IjoiY2FtdmR2cmllcyIsImEiOiJjajA4NXdpNmswMDB2MzNzMjk4dGM2cnhzIn0.lIwd8N7wf0hx7mq-kjTcbQ","map-style":"mapbox://styles/mapbox/satellite-streets-v10",center:[34.85752836605343,-19.830506337137294],zoom:10,pitch:60,bearing:-132,"min-zoom":5,id:"map"}},[t("v-results-layers"),e._v(" "),t("v-exposure-layers"),e._v(" "),t("v-hazards"),e._v(" "),t("div",{attrs:{id:"popupinfo"}},[t("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.items,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(a){return[t("td",[e._v(e._s(a.item.name))]),e._v(" "),t("td",{staticClass:"text-xs-right"},[e._v(e._s(a.item.data))])]}}])})],1)],1)],1)]),e._v(" "),t("v-footer",{attrs:{color:"indigo",app:""}},[t("span",{staticClass:"white--text"},[e._v("© 2017")])])],1)},staticRenderFns:[]};var z=t("VU/8")(x,C,!1,function(e){t("QU9V")},null,null).exports,j=t("5BM0"),E=t.n(j);t("7zck");r.a.use(E.a),r.a.use(i.a),r.a.config.productionTip=!1,new r.a({el:"#app",template:"<App/>",components:{App:z}})},QU9V:function(e,a){},Qj4d:function(e,a){},jQz1:function(e,a){},t9Zi:function(e,a){},xcLp:function(e,a,t){e.exports=t.p+"static/img/logos.d8e69e3.png"}},["NHnr"]);
//# sourceMappingURL=app.8aef6afd0b250eb824e0.js.map