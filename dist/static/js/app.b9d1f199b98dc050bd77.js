webpackJsonp([1],{"2Bfm":function(e,t){},"3fWC":function(e,t){},"7zck":function(e,t){},JQYu:function(e,t){},LvUh:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("7+uW"),n=a("3EgV"),i=a.n(n),o=new r.a,s=a("1e2d"),l=a.n(s),c=a("M4fF"),u=a.n(c),d={name:"layer-control",props:{layers:{type:Array,required:!0},map:{type:Object}},data:function(){return{returnPeriod:null,selectResults:null,selectHazards:null}},mounted:function(){},watch:{layers:{handler:function(e){this.toggleLayers()},deep:!0},returnPeriod:{handler:function(e){this.toggleLayers()},deep:!0},selectResults:{handler:function(e){this.selectResults=e,this.toggleLayers()},deep:!0},selectHazards:{handler:function(e){this.selectHazards=e,this.toggleLayers()},deep:!0}},methods:{toggleLayers:function(){var e=this;if(!u.a.isNil(this.map)){var t=["none","visible"];u.a.each(this.layers,function(a){u.a.each(a.json_layers,function(r){u.a.each(r.data,function(n){a.active&&(e.returnPeriod===n.returnPeriod||e.selectResults===r.name&&n.hazard===e.selectHazards||"Exposure"===a.content)?e.map.setLayoutProperty(n.id,"visibility",t[1]):e.map.setLayoutProperty(n.id,"visibility",t[0])})})})}}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"layer-control"},[a("v-list-tile",[a("v-list-tile-title",[e._v("\r\n      Return period\r\n    ")]),e._v(" "),a("v-list-tile-action",[a("v-radio-group",{model:{value:e.returnPeriod,callback:function(t){e.returnPeriod=t},expression:"returnPeriod"}},[a("v-layout",{attrs:{row:""}},e._l([25,100,500],function(e){return a("v-radio",{key:e,attrs:{label:" "+e,value:e}})}))],1)],1)],1),e._v(" "),e._l(e.layers,function(t){return"Exposure"==t.content?a("v-list",{key:t.id,attrs:{dense:"","pt-0":""}},[e._v("\r\n    School Exposure\r\n    "),a("v-divider"),e._v(" "),a("v-list-tile",[a("v-list-tile-action",[a("v-switch",{model:{value:t.active,callback:function(a){e.$set(t,"active",a)},expression:"layer.active"}})],1),e._v(" "),a("v-list-tile-title",[e._v(e._s(t.name))]),e._v(" "),a("v-list-tile-action",[a("v-icon",[e._v(e._s(t.icon))])],1)],1),e._v(" "),a("div",{staticClass:"bar-wrapper"},[t.css?a("div",{staticClass:"bar",style:t.css}):e._e(),e._v(" "),a("div",{staticClass:"bartext"},[e._v(e._s(t.range)+" "),a("span",{staticClass:"barspan"})]),e._v(" "),a("div",{staticClass:"information",domProps:{innerHTML:e._s(t.info)}},[e._v(e._s(t.info)+" ")])])],1):e._e()}),e._v(" "),e._l(e.layers,function(t){return"Hazards"==t.content?a("v-list",{key:t.id,attrs:{dense:"","pt-0":""}},[e._v("\r\n    Hazards\r\n    "),a("v-divider"),e._v(" "),a("v-list-tile",[a("v-list-tile-action",[a("v-switch",{model:{value:t.active,callback:function(a){e.$set(t,"active",a)},expression:"layer.active"}})],1),e._v(" "),a("v-list-tile-title",[a("select",{directives:[{name:"model",rawName:"v-model",value:e.selectHazards,expression:"selectHazards"}],attrs:{label:"Select","item-text":"name","item-value":"name",light:"","single-line":"",auto:""},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selectHazards=t.target.multiple?a:a[0]}}},[e._v("Select\r\n          "),e._l(t.json_layers,function(t){return a("option",{key:t.id,domProps:{value:t.name}},[e._v("\r\n          "+e._s(t.name)+"\r\n        ")])})],2)]),e._v(" "),a("v-list-tile-action",[a("v-icon",[e._v(e._s(t.icon))])],1)],1),e._v(" "),a("div",{staticClass:"bar-wrapper"},[t.css?a("div",{staticClass:"bar",style:t.css}):e._e(),e._v(" "),a("div",{staticClass:"bartext"},[e._v(e._s(t.range)+" "),a("span",{staticClass:"barspan"})]),e._v(" "),a("div",{staticClass:"information",domProps:{innerHTML:e._s(t.info)}},[e._v(e._s(t.info)+" ")])])],1):e._e()}),e._v(" "),e._l(e.layers,function(t){return"Results"==t.content?a("v-list",{key:t.id,attrs:{dense:"","pt-0":""}},[e._v("\r\n    Results\r\n    "),a("v-divider"),e._v(" "),a("v-list-tile",[a("v-list-tile-action",[a("v-switch",{model:{value:t.active,callback:function(a){e.$set(t,"active",a)},expression:"layer.active"}})],1),e._v(" "),a("v-list-tile-title",[a("select",{directives:[{name:"model",rawName:"v-model",value:e.selectResults,expression:"selectResults"}],attrs:{label:"Select","item-text":"name","item-value":"name",light:"","single-line":"",auto:""},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selectResults=t.target.multiple?a:a[0]}}},[e._v("Select\r\n          "),e._l(t.json_layers,function(t){return a("option",{key:t.id,domProps:{value:t.name}},[e._v("\r\n          "+e._s(t.name)+"\r\n        ")])})],2)]),e._v(" "),a("v-list-tile-action",[a("v-icon",[e._v(e._s(t.icon))])],1)],1),e._v(" "),a("div",{staticClass:"bar-wrapper"},[t.css?a("div",{staticClass:"bar",style:t.css}):e._e(),e._v(" "),a("div",{staticClass:"bartext"},[e._v(e._s(t.range)+" "),a("span",{staticClass:"barspan"})]),e._v(" "),a("div",{staticClass:"information",domProps:{innerHTML:e._s(t.info)}},[e._v(e._s(t.info)+" ")])])],1):e._e()})],2)},staticRenderFns:[]};var p=a("VU/8")(d,v,!1,function(e){a("2Bfm")},null,null).exports,m={name:"v-hazards",data:function(){return{map:null}},mounted:function(){},methods:{deferredMountedTo:function(e){var t={name:"Hazards",id:"hazards",icon:"priority-high",active:!1,content:"Hazards",json_layers:[],range:"0 700",css:"background: linear-gradient(to right,           rgba(247,251,255,40),           rgba(104,160,213,117),           rgba(60,148,201,166),           rgba(49,118,163,202),           rgba(25,86,138,223),           rgba(9,57,129,255))"},a={name:"Coastal Flood",data:[{id:"CF-layer-25",layout:{visibility:"none"},type:"raster",returnPeriod:25,source:{type:"raster",url:"mapbox://joaolima.588zuz9x",tileSize:256}},{id:"CF-layer-100",layout:{visibility:"none"},type:"raster",returnPeriod:100,source:{type:"raster",url:"mapbox://joaolima.awl4l0w6",tileSize:256}},{id:"CF-layer-500",layout:{visibility:"none"},type:"raster",returnPeriod:500,source:{type:"raster",url:"mapbox://joaolima.84gdnnj5",tileSize:256}}]};t.json_layers.push(a),_.each(a.data,function(t){console.log("CF_layer",t),e.addLayer(t)}),console.log("hazard_layer",t),o.$emit("add-layer",t)}}},y={name:"v-results-layers",data:function(){return{map:null}},mounted:function(){},methods:{deferredMountedTo:function(e){var t=this,a={active:!1,content:"Results",icon:"home",id:"results",json_layers:[]};this.map=e;var r=[{name:"Conventional USD",textcolor:"rgba(199, 23, 220, 1)",data:[{hazard:"Coastal Flood",id:"CF-conventional-usd",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.4ph2ua2g"},"source-layer":"CF_conventional_usd-a3oswd",paint:{"fill-color":"rgba(199, 23, 220, 0.26)","fill-outline-color":"rgba(199, 23, 220, 1)"}}]},{name:"Unconventional USD",textcolor:"rgba(0, 64, 231, 1)",data:[{hazard:"Coastal Flood",id:"CF-unconventional-usd",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.drs7l8os"},"source-layer":"CF_unconventional_usd-bv0i45",paint:{"fill-color":"rgba(0, 64, 231, 0.26)","fill-outline-color":"rgba(0, 64, 231, 1)"}}]},{name:"Conventional count",textcolor:"rgba(242, 220, 19, 1)",data:[{hazard:"Coastal Flood",id:"CF-conventional-count",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.15kwtp2e"},"source-layer":"CF_conventional_count30-887azr",paint:{"fill-color":"rgba(242, 220, 19, 0.26)","fill-outline-color":"rgba(242, 220, 19, 1)"}}]},{name:"Unconventional Count",textcolor:"rgba(52, 220, 58, 1)",data:[{hazard:"Coastal Flood",id:"CF-unconventional-count",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.3sywikko"},"source-layer":"CF_unconventional_count30-dwzjx9",paint:{"fill-color":"rgba(52, 220, 58, 0.26)","fill-outline-color":"rgba(52, 220, 58, 1)"}}]},{name:"Pupils",textcolor:"rgba(250, 24, 21, 1)",data:[{hazard:"Coastal Flood",id:"CF-pupils",layout:{visibility:"none"},type:"fill",source:{type:"vector",url:"mapbox://joaolima.36ig2zci"},"source-layer":"CF_pupils-4q3ft2",paint:{"fill-color":"rgba(250, 24, 21, 0.26)","fill-outline-color":"rgba(250, 24, 21, 1)"}}]}];_.each(r,function(e){a.json_layers.push(e),t.map.addLayer(e.data[0])}),o.$emit("add-layer",a)}}},f={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"hidden"})},staticRenderFns:[]};var h=a("VU/8")(y,f,!1,function(e){a("LvUh")},"data-v-34331114",null).exports,b={name:"v-exposure-layers",data:function(){return{map:null}},mounted:function(){},methods:{deferredMountedTo:function(e){var t={active:!1,content:"Exposure",icon:"home",id:"results",name:"Combined exposure",json_layers:[]},a={name:"Combined exposure",textcolor:"rgba(199, 23, 220, 1)",data:[{id:"combined-exposure",layout:{visibility:"none"},type:"circle",source:{type:"vector",url:"mapbox://joaolima.cg24n2xe"},"source-layer":"Combined_Exposure-3noze9",paint:{}}]};this.map=e,t.json_layers.push(a),this.map.addLayer(a.data[0]),o.$emit("add-layer",t)}}},g={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"hidden"})},staticRenderFns:[]};var x={name:"app",data:function(){return{map:null,drawer:null,layers:[],headers:[{text:"",align:"left",sortable:!1,value:"name"},{text:"1/10 year return period",value:"rp10"},{text:"1/100 year return period",value:"rp100"},{text:"1/500 year return period",value:"rp500"},{text:"Annual Expected Data",value:"AED"}],items:[]}},mounted:function(){var e=this;this.map=this.$refs.map.map;var t=new l.a.Popup({}),a=document.getElementById("popupinfo");t.setDOMContent(a),o.$on("select-layers",function(t){r.a.set(e,"layers",t)}),o.$on("add-layer",function(t){e.layers.push(t)}),this.map.on("error",function(e){return console.log(e)}),this.map.on("load",function(a){e.map.on("mousemove",function(t){e.$refs.map.map.getCanvas().style.cursor="",void 0!==e.map.queryRenderedFeatures(t.point)[0]&&(e.$refs.map.map.getCanvas().style.cursor="pointer")}),o.$emit("map-loaded",e.$refs.map.map),e.map.addControl(new l.a.NavigationControl),e.map.on("click",function(a){var r=e.map.queryRenderedFeatures(a.point);console.log(r),"combined-exposure"!==r[0].layer.id&&(t.remove(),e.items=[{value:!1,name:r[0].layer.id,rp10:r[0].properties[10],rp100:r[0].properties[100],rp500:r[0].properties[500],AED:r[0].properties.AED}],e.headers[0].text=r[0].properties.ADM1_NAME+", "+r[0].properties.ADM2_NAME,t.setLngLat(a.lngLat).addTo(e.map))})})},watch:{},methods:{},components:{"layer-control":p,"v-hazards":m,"v-exposure-layers":a("VU/8")(b,g,!1,function(e){a("JQYu")},"data-v-4e120188",null).exports,"v-results-layers":h}},C={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",{attrs:{id:"inspire"}},[a("v-navigation-drawer",{attrs:{fixed:"",app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("v-toolbar",{attrs:{flat:""}},[a("v-list",[a("v-list-tile",[a("v-list-tile-title",{staticClass:"title"},[e._v("\n            Layers\n          ")])],1)],1)],1),e._v(" "),a("layer-control",{attrs:{layers:e.layers,map:e.map}})],1),e._v(" "),a("v-toolbar",{attrs:{color:"indigo",dark:"",fixed:"",app:""}},[a("v-toolbar-side-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),e._v(" "),a("v-toolbar-title",[e._v("Safer schools viewer")])],1),e._v(" "),a("v-content",[a("div",{attrs:{id:"map"}},[a("v-mapbox",{ref:"map",attrs:{"access-token":"pk.eyJ1IjoiY2FtdmR2cmllcyIsImEiOiJjajA4NXdpNmswMDB2MzNzMjk4dGM2cnhzIn0.lIwd8N7wf0hx7mq-kjTcbQ","map-style":"mapbox://styles/mapbox/streets-v9",center:[34.85752836605343,-19.830506337137294],zoom:10,pitch:60,bearing:-132,"min-zoom":5,id:"map"}},[a("v-hazards"),e._v(" "),a("v-results-layers"),e._v(" "),a("v-exposure-layers"),e._v(" "),a("div",{attrs:{id:"popupinfo"}},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.items,"hide-actions":""},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[e._v(e._s(t.item.name))]),e._v(" "),a("td",{staticClass:"text-xs-right"},[e._v(e._s(t.item.rp10))]),e._v(" "),a("td",{staticClass:"text-xs-right"},[e._v(e._s(t.item.rp100))]),e._v(" "),a("td",{staticClass:"text-xs-right"},[e._v(e._s(t.item.rp500))]),e._v(" "),a("td",{staticClass:"text-xs-right"},[e._v(e._s(t.item.AED))])]}}])})],1)],1)],1)]),e._v(" "),a("v-footer",{attrs:{color:"indigo",app:""}},[a("span",{staticClass:"white--text"},[e._v("Â© 2017")])])],1)},staticRenderFns:[]};var z=a("VU/8")(x,C,!1,function(e){a("3fWC")},null,null).exports,w=a("5BM0"),F=a.n(w);a("7zck");r.a.use(F.a),r.a.use(i.a),r.a.config.productionTip=!1,new r.a({el:"#app",template:"<App/>",components:{App:z}})}},["NHnr"]);
//# sourceMappingURL=app.b9d1f199b98dc050bd77.js.map